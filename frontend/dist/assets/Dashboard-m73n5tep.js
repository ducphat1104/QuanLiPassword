import{j as e,A as t,m as s}from"./ui-C_uF5axt.js";import{r,R as a}from"./vendor-Bz3rmKJE.js";import{y as n,a as o,z as i}from"./utils-D2tVOWfX.js";import{H as l,B as c}from"./BottomNavigation-CeuEuRIY.js";import{u as d,t as m,a as u,A as h,L as x}from"./index-Dn1ZvxfH.js";import{F as p,a as b,b as g,c as f,d as y,e as v,f as j,g as w,h as N,i as k,j as C,k as S,l as M,m as T,n as O,o as E,p as D,q as L,r as $,s as F,t as P,u as B,v as A,w as R,x as U,y as z}from"./ThemeToggle-DM9h1x9n.js";import{P as _,C as X,A as Y,p as I,a as K,b as H}from"./charts-B7bDZ40n.js";import{P as W}from"./PageTransition-C1kLGRwo.js";import"./router-Dp9ZVfyb.js";const V={delta:10,preventScrollOnSwipe:!1,rotationAngle:0,trackMouse:!1,trackTouch:!0,swipeDuration:1/0,touchEventOptions:{passive:!0}},Z={first:!0,initial:[0,0],start:0,swiping:!1,xy:[0,0]},q="mousemove",G="mouseup";function J(e,t){if(0===t)return e;const s=Math.PI/180*t;return[e[0]*Math.cos(s)+e[1]*Math.sin(s),e[1]*Math.cos(s)-e[0]*Math.sin(s)]}function Q(e,t){const s=t=>{const s="touches"in t;s&&t.touches.length>1||e((e,a)=>{a.trackMouse&&!s&&(document.addEventListener(q,r),document.addEventListener(G,n));const{clientX:o,clientY:i}=s?t.touches[0]:t,l=J([o,i],a.rotationAngle);return a.onTouchStartOrOnMouseDown&&a.onTouchStartOrOnMouseDown({event:t}),Object.assign(Object.assign(Object.assign({},e),Z),{initial:l.slice(),xy:l,start:t.timeStamp||0})})},r=t=>{e((e,s)=>{const r="touches"in t;if(r&&t.touches.length>1)return e;if(t.timeStamp-e.start>s.swipeDuration)return e.swiping?Object.assign(Object.assign({},e),{swiping:!1}):e;const{clientX:a,clientY:n}=r?t.touches[0]:t,[o,i]=J([a,n],s.rotationAngle),l=o-e.xy[0],c=i-e.xy[1],d=Math.abs(l),m=Math.abs(c),u=(t.timeStamp||0)-e.start,h=Math.sqrt(d*d+m*m)/(u||1),x=[l/(u||1),c/(u||1)],p=function(e,t,s,r){return e>t?s>0?"Right":"Left":r>0?"Down":"Up"}(d,m,l,c),b="number"==typeof s.delta?s.delta:s.delta[p.toLowerCase()]||V.delta;if(d<b&&m<b&&!e.swiping)return e;const g={absX:d,absY:m,deltaX:l,deltaY:c,dir:p,event:t,first:e.first,initial:e.initial,velocity:h,vxvy:x};g.first&&s.onSwipeStart&&s.onSwipeStart(g),s.onSwiping&&s.onSwiping(g);let f=!1;return(s.onSwiping||s.onSwiped||s[`onSwiped${p}`])&&(f=!0),f&&s.preventScrollOnSwipe&&s.trackTouch&&t.cancelable&&t.preventDefault(),Object.assign(Object.assign({},e),{first:!1,eventData:g,swiping:!0})})},a=t=>{e((e,s)=>{let r;if(e.swiping&&e.eventData){if(t.timeStamp-e.start<s.swipeDuration){r=Object.assign(Object.assign({},e.eventData),{event:t}),s.onSwiped&&s.onSwiped(r);const a=s[`onSwiped${r.dir}`];a&&a(r)}}else s.onTap&&s.onTap({event:t});return s.onTouchEndOrOnMouseUp&&s.onTouchEndOrOnMouseUp({event:t}),Object.assign(Object.assign(Object.assign({},e),Z),{eventData:r})})},n=e=>{document.removeEventListener(q,r),document.removeEventListener(G,n),a(e)},o=(e,t)=>{let n=()=>{};if(e&&e.addEventListener){const o=Object.assign(Object.assign({},V.touchEventOptions),t.touchEventOptions),i=[["touchstart",s,o],["touchmove",r,Object.assign(Object.assign({},o),t.preventScrollOnSwipe?{passive:!1}:{})],["touchend",a,o]];i.forEach(([t,s,r])=>e.addEventListener(t,s,r)),n=()=>i.forEach(([t,s])=>e.removeEventListener(t,s))}return n},i={ref:t=>{null!==t&&e((e,s)=>{if(e.el===t)return e;const r={};return e.el&&e.el!==t&&e.cleanUpTouch&&(e.cleanUpTouch(),r.cleanUpTouch=void 0),s.trackTouch&&t&&(r.cleanUpTouch=o(t,s)),Object.assign(Object.assign(Object.assign({},e),{el:t}),r)})}};return t.trackMouse&&(i.onMouseDown=s),[i,o]}function ee(e){const{trackMouse:t}=e,s=r.useRef(Object.assign({},Z)),a=r.useRef(Object.assign({},V)),n=r.useRef(Object.assign({},a.current));let o;for(o in n.current=Object.assign({},a.current),a.current=Object.assign(Object.assign({},V),e),V)void 0===a.current[o]&&(a.current[o]=V[o]);const[i,l]=r.useMemo(()=>Q(e=>s.current=e(s.current,a.current),{trackMouse:t}),[t]);return s.current=function(e,t,s,r){return t.trackTouch&&e.el?e.cleanUpTouch?t.preventScrollOnSwipe!==s.preventScrollOnSwipe||t.touchEventOptions.passive!==s.touchEventOptions.passive?(e.cleanUpTouch(),Object.assign(Object.assign({},e),{cleanUpTouch:r(e.el,t)})):e:Object.assign(Object.assign({},e),{cleanUpTouch:r(e.el,t)}):(e.cleanUpTouch&&e.cleanUpTouch(),Object.assign(Object.assign({},e),{cleanUpTouch:void 0}))}(s.current,a.current,n.current,l),i}const te="light",se="medium",re="heavy",ae="success",ne="warning",oe="error",ie="selection",le=(e=te)=>{if(!navigator.vibrate&&!window.navigator.vibrate)return;if(!/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent))return;const t={[te]:[10],[se]:[20],[re]:[30],[ae]:[10,50,10],[ne]:[20,100,20],[oe]:[50,100,50,100,50],[ie]:[5]},s=t[e]||t[te];try{navigator.vibrate?navigator.vibrate(s):window.navigator.vibrate&&window.navigator.vibrate(s)}catch(r){}},ce=()=>le(te),de=()=>le(oe),me=()=>le(ie),ue=()=>le(se),he=()=>le(ae),xe=()=>le(se),pe=()=>le(te),be=()=>le(ae),ge=({isOpen:a,onClose:n,serviceName:o,onSuccess:i})=>{const[l,c]=r.useState(""),[m,u]=r.useState(!1),[h,x]=r.useState(!0),[j,w]=r.useState(!1),[N,k]=r.useState(""),C=r.useRef(null),{authenticate:S,rememberDuration:M,loading:T}=d();r.useEffect(()=>{},[M,T]),r.useEffect(()=>{a&&C.current&&setTimeout(()=>{C.current.focus()},100)},[a]),r.useEffect(()=>{a||(c(""),u(!1),k(""),w(!1))},[a]);const[O,E]=r.useState(null);return e.jsx(t,{children:a&&e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[e.jsx(s.div,{variants:{hidden:{opacity:0},visible:{opacity:1},exit:{opacity:0}},initial:"hidden",animate:"visible",exit:"exit",className:"absolute inset-0 bg-black/50 backdrop-blur-sm",onClick:n}),e.jsxs(s.div,{variants:{hidden:{opacity:0,scale:.95,y:20},visible:{opacity:1,scale:1,y:0,transition:{type:"spring",damping:25,stiffness:300,duration:.3}},exit:{opacity:0,scale:.95,y:20,transition:{duration:.2}}},initial:"hidden",animate:"visible",exit:"exit",className:"relative w-full max-w-sm sm:max-w-md mx-3 sm:mx-4 bg-card-bg rounded-2xl shadow-2xl border border-border-primary overflow-hidden",onKeyDown:e=>{"Escape"===e.key&&n()},onTouchStart:e=>{const t=e.touches[0];E({x:t.clientX,y:t.clientY})},onTouchEnd:e=>{if(!O)return;const t=e.changedTouches[0],s=t.clientY-O.y,r=Math.abs(t.clientX-O.x);s>100&&r<50&&n(),E(null)},tabIndex:-1,children:[e.jsx("div",{className:"sm:hidden flex justify-center pt-2 pb-1",children:e.jsx("div",{className:"w-8 h-1 bg-text-tertiary/30 rounded-full"})}),e.jsx("div",{className:"bg-gradient-to-r from-primary-custom/10 to-blue-500/10 p-5 sm:p-6 border-b border-border-primary",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{className:"flex items-start space-x-3 flex-1 min-w-0",children:[e.jsx("div",{className:"p-2 bg-primary-custom/20 rounded-lg flex-shrink-0",children:e.jsx(p,{className:"w-6 h-6 sm:w-7 sm:h-7 text-primary-custom"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("h3",{className:"text-lg sm:text-xl font-semibold text-text-primary",children:"Xác Thực Bảo Mật"}),e.jsxs("p",{className:"text-sm sm:text-base text-text-secondary",children:["Để xem mật khẩu của ",e.jsx("span",{className:"text-primary-custom font-medium",children:o})]})]})]}),e.jsx("button",{onClick:n,className:"hidden sm:flex p-2 hover:bg-bg-tertiary rounded-lg transition-colors duration-200 flex-shrink-0",children:e.jsx(b,{className:"w-5 h-5 text-text-tertiary"})})]})}),e.jsxs("form",{onSubmit:async e=>{var t;if(e.preventDefault(),!l.trim())return void k("Vui lòng nhập mật khẩu cấp 2");w(!0),k("");await S(l)?(i(),n()):(k("Mật khẩu cấp 2 không đúng"),c(""),null==(t=C.current)||t.focus()),w(!1)},className:"p-4 sm:p-6 space-y-4 sm:space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary",children:"Mật khẩu cấp 2"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(g,{className:"w-5 h-5 text-text-tertiary"})}),e.jsx("input",{ref:C,type:m?"text":"password",value:l,onChange:e=>{c(e.target.value),k("")},className:"w-full pl-10 pr-12 py-3 bg-bg-tertiary border rounded-lg focus:ring-2 focus:ring-primary-custom focus:border-primary-custom transition-all duration-200 text-base "+(N?"border-red-500":"border-border-primary"),placeholder:"Nhập mật khẩu cấp 2 của bạn",disabled:j}),e.jsx("button",{type:"button",onClick:()=>u(!m),className:"absolute inset-y-0 right-0 pr-3 flex items-center hover:text-text-primary transition-colors duration-200",disabled:j,children:m?e.jsx(f,{className:"w-5 h-5 text-text-tertiary"}):e.jsx(y,{className:"w-5 h-5 text-text-tertiary"})})]}),N&&e.jsxs(s.p,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"text-sm text-red-500 flex items-center space-x-1",children:[e.jsx("span",{children:"⚠️"}),e.jsx("span",{children:N})]})]}),e.jsxs("div",{className:"flex items-start space-x-3 p-3 bg-bg-tertiary/50 rounded-lg",children:[e.jsx("input",{type:"checkbox",id:"rememberSession",checked:h,onChange:e=>x(e.target.checked),className:"w-4 h-4 text-primary-custom bg-bg-tertiary border-border-primary rounded focus:ring-primary-custom focus:ring-2 mt-0.5 flex-shrink-0",disabled:j}),e.jsx("label",{htmlFor:"rememberSession",className:"flex-1 text-sm text-text-secondary min-w-0",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(v,{className:"w-4 h-4 flex-shrink-0"}),e.jsx("span",{className:"break-words",children:T?"Đang tải...":0===M?"Luôn hỏi mật khẩu":`Nhớ trong ${M||30} phút`})]})})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 pt-2 pb-20 sm:pb-0",children:[e.jsx("button",{type:"button",onClick:n,className:"flex-1 px-4 py-3 bg-bg-tertiary text-text-secondary rounded-lg hover:bg-text-tertiary hover:text-text-primary transition-all duration-200 font-medium min-h-[44px] flex items-center justify-center",disabled:j,children:e.jsx("span",{className:"text-sm",children:"Hủy"})}),e.jsx("button",{type:"submit",disabled:j||!l.trim(),className:"flex-1 px-4 py-3 bg-gradient-to-r from-primary-custom to-blue-600 text-white rounded-lg hover:from-primary-hover hover:to-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200 font-medium flex items-center justify-center space-x-2 min-h-[44px]",children:j?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"}),e.jsx("span",{className:"text-sm",children:"Đang xác thực..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(p,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm",children:"Xác nhận"})]})})]})]})]})]})})},fe=({serviceName:t})=>{const[s,a]=r.useState(!1);r.useEffect(()=>{a(!1)},[t]);const n={facebook:"facebook.com",fb:"facebook.com",instagram:"instagram.com",ig:"instagram.com",zalo:"zalo.me",telegram:"telegram.org",google:"google.com",github:"github.com",garena:"garena.vn",shopee:"shopee.vn",tiktok:"tiktok.com",vnpay:"vnpay.vn",vietcombank:"vietcombank.com.vn",techcombank:"techcombank.com.vn",acb:"acb.com.vn",bidv:"bidv.com.vn",vietinbank:"vietinbank.vn",mbbank:"mbbank.com.vn",vpbank:"vpbank.com.vn"},o=(e=>{if(!e)return null;const t=e.toLowerCase();for(const s in n)if(t.includes(s))return n[s];return null})(t);if(o&&!s){const s=`https://logo.clearbit.com/${o}`;return e.jsx("img",{src:s,alt:`${t} logo`,className:"w-8 h-8 rounded-md object-contain bg-white",onError:()=>a(!0)})}return(t=>{const s="w-8 h-8",r=t.toLowerCase();return r.includes("google")?e.jsx(M,{className:`${s} text-red-500`}):r.includes("facebook")?e.jsx(T,{className:`${s} text-blue-600`}):r.includes("github")?e.jsx(O,{className:`${s} text-gray-800`}):r.includes("bank")?e.jsx(E,{className:`${s} text-green-600`}):e.jsx(D,{className:`${s} text-gray-500`})})(t)},ye=({data:t,onSoftDelete:s,onEditClick:a,token:i,API_URL:l})=>{const[c,u]=r.useState(!1),[h,x]=r.useState(""),[p,b]=r.useState(!1),[v,M]=r.useState(!1),[T,O]=r.useState(0),[E,D]=r.useState(!1),[L,$]=r.useState(!1),F=r.useRef(null),{isEnabled:P,checkSession:B}=d();r.useEffect(()=>{const e=e=>{F.current&&!F.current.contains(e.target)&&M(!1)};return v&&document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[v]);const A=(e,t)=>{if(!e)return de(),void n.warn("Không có gì để sao chép!");navigator.clipboard.writeText(e).then(()=>{he(),n.success(`${t} đã được sao chép vào clipboard!`)}).catch(e=>{de(),n.error("Không thể sao chép!")})},R=async()=>{if(h)u(!0);else{b(!0);try{const e=await o.get(`${l}/${t._id}/decrypt`,{headers:{"x-auth-token":i}});x(e.data.decryptedPassword),u(!0)}catch(e){n.error("Không thể giải mã mật khẩu.")}finally{b(!1)}}},U=()=>{const r=`delete-${t._id}`;m.custom(e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold mb-2",children:"Chuyển vào thùng rác?"}),e.jsx("p",{className:"text-sm mb-3",children:"Mật khẩu này sẽ được chuyển vào thùng rác và có thể khôi phục trong 30 ngày."}),e.jsxs("div",{className:"flex justify-end gap-2 mt-4",children:[e.jsx("button",{onClick:()=>{s(t._id),m.dismiss(r)},className:"bg-danger-custom hover:bg-red-700 text-white font-bold py-1 px-3 rounded text-sm transition-colors duration-200",children:"Đồng ý"}),e.jsx("button",{onClick:()=>m.dismiss(r),className:"bg-bg-tertiary hover:bg-text-tertiary text-text-primary font-bold py-1 px-3 rounded text-sm transition-colors duration-200",children:"Hủy"})]})]}),"info",r,{position:"top-center",autoClose:!1,closeOnClick:!1,closeButton:!1,draggable:!1})},z=ee({onSwipedLeft:e=>{O(-80),D(!0)},onSwipedRight:e=>{O(80),D(!0)},onSwiping:e=>{const t=Math.max(-100,Math.min(100,e.deltaX));Math.abs(t)>15&&(O(t),D(Math.abs(t)>30))},onSwiped:e=>{setTimeout(()=>{O(0),D(!1)},2e3)},trackMouse:!0,trackTouch:!0,preventScrollOnSwipe:!0,delta:15,swipeDuration:500,touchEventOptions:{passive:!1}});return e.jsxs("div",{className:"relative overflow-hidden",children:[(E||Math.abs(T)>15)&&e.jsxs(e.Fragment,{children:[T>15&&e.jsxs("div",{className:"absolute inset-0 bg-green-500 flex items-center justify-start pl-6 rounded-lg transition-opacity duration-200",style:{opacity:Math.min(1,Math.abs(T)/60)},children:[e.jsx(j,{className:"text-white text-2xl"}),e.jsx("span",{className:"text-white font-bold ml-2 text-lg",children:"Sửa"})]}),T<-15&&e.jsxs("div",{className:"absolute inset-0 bg-red-500 flex items-center justify-end pr-6 rounded-lg transition-opacity duration-200",style:{opacity:Math.min(1,Math.abs(T)/60)},children:[e.jsx("span",{className:"text-white font-bold mr-2 text-lg",children:"Xóa"}),e.jsx(w,{className:"text-white text-2xl"})]})]}),e.jsxs("div",{...z,className:"bg-gradient-to-br from-card-bg via-card-bg/98 to-card-bg/95 backdrop-blur-sm rounded-2xl shadow-lg hover:shadow-2xl p-4 flex flex-col justify-between transition-all duration-300 transform hover:-translate-y-3 hover:scale-[1.02] relative border-2 border-border-primary/50 hover:border-primary-custom/40 cursor-pointer select-none group",style:{transform:`translateX(${Math.max(-80,Math.min(80,T))}px)`,transition:E?"none":"all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94)",transformStyle:"preserve-3d",boxShadow:E?"none":"0 10px 30px rgba(0,0,0,0.1), 0 1px 8px rgba(0,0,0,0.2), inset 0 1px 0 rgba(255,255,255,0.1)"},onMouseMove:e=>{if(!E){const t=e.currentTarget.getBoundingClientRect(),s=e.clientX-t.left,r=e.clientY-t.top,a=t.width/2,n=(r-t.height/2)/15,o=(a-s)/15;e.currentTarget.style.transform=`\n                            translateX(${Math.max(-80,Math.min(80,T))}px)\n                            perspective(1000px)\n                            rotateX(${n}deg)\n                            rotateY(${o}deg)\n                            translateY(-12px)\n                            translateZ(10px)\n                            scale(1.02)\n                        `}},onMouseLeave:e=>{M(!1),E||(e.currentTarget.style.transform=`\n                            translateX(${Math.max(-80,Math.min(80,T))}px)\n                            perspective(1000px)\n                            rotateX(0deg)\n                            rotateY(0deg)\n                            translateY(0px)\n                            translateZ(0px)\n                            scale(1)\n                        `)},onClick:()=>{E&&(T>40?(m.dismiss(`delete-${t._id}`),xe(),a(t),O(0),D(!1)):T<-40&&(m.dismissByType("info"),U(),O(0),D(!1)))},children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center min-w-0 flex-1",children:[e.jsxs("div",{className:"flex-shrink-0 relative",children:[e.jsx("div",{className:"absolute inset-0 bg-primary-custom/20 rounded-lg blur-sm opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),e.jsx(fe,{serviceName:t.serviceName,className:"w-8 h-8 relative z-10 transition-transform duration-300 group-hover:scale-110"})]}),e.jsxs("div",{className:"ml-3 min-w-0 flex-1",children:[e.jsx("h3",{className:"text-sm font-bold text-text-primary truncate",children:t.serviceName}),t.category&&"Chưa phân loại"!==t.category&&e.jsx("span",{className:"text-xs bg-primary-custom/10 text-primary-custom rounded-full mt-1 inline-block",children:t.category})]})]}),e.jsxs("div",{className:"relative",ref:F,children:[e.jsx("button",{onClick:()=>M(!v),className:"text-text-tertiary hover:text-text-secondary transition-all duration-300 p-2 rounded-lg hover:bg-gradient-to-r hover:from-bg-tertiary/50 hover:to-bg-tertiary/30 opacity-0 group-hover:opacity-100 transform hover:scale-110 hover:rotate-90 active:scale-95","aria-label":"More options",children:e.jsx(N,{className:"w-4 h-4 transition-transform duration-300"})}),v&&e.jsxs("div",{className:"absolute right-0 top-full mt-2 w-40 bg-gradient-to-br from-card-bg to-card-bg/95 backdrop-blur-sm rounded-xl shadow-2xl border border-border-primary/50 z-50 overflow-hidden animate-in slide-in-from-top-2 fade-in duration-300",children:[e.jsxs("button",{onClick:()=>{m.dismiss(`delete-${t._id}`),xe(),a(t),M(!1)},className:"flex items-center w-full text-left px-3 py-2.5 text-sm text-text-primary hover:bg-gradient-to-r hover:from-blue-500/10 hover:to-blue-400/5 transition-all duration-300 transform hover:translate-x-1",children:[e.jsx(j,{className:"w-4 h-4 mr-2 text-text-secondary transition-transform duration-300 hover:scale-110"})," Sửa"]}),e.jsxs("button",{onClick:()=>{m.dismissByType("info"),U(),M(!1)},className:"flex items-center w-full text-left px-3 py-2.5 text-sm text-danger-custom hover:bg-gradient-to-r hover:from-red-500/10 hover:to-red-400/5 transition-all duration-300 transform hover:translate-x-1",children:[e.jsx(w,{className:"w-4 h-4 mr-2 transition-transform duration-300 hover:scale-110"})," Xóa"]})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("label",{className:"text-xs font-medium text-text-secondary flex items-center",children:[e.jsx(k,{className:"w-3 h-3 mr-1"}),"Tên đăng nhập"]}),e.jsx("button",{onClick:()=>A(t.username,"Tên người dùng"),className:"p-1.5 rounded-lg hover:bg-gradient-to-r hover:from-primary-custom/20 hover:to-primary-custom/10 text-text-tertiary hover:text-primary-custom transition-all duration-300 transform hover:scale-110 hover:-translate-y-0.5 hover:shadow-lg active:scale-95 active:translate-y-0","aria-label":"Copy username",children:e.jsx(C,{className:"w-3 h-3 transition-transform duration-300 group-hover:rotate-12"})})]}),e.jsx("div",{className:"bg-gradient-to-r from-bg-tertiary/30 to-bg-tertiary/20 rounded-lg px-3 py-2 text-sm text-text-primary font-mono break-all transition-all duration-300 hover:from-bg-tertiary/40 hover:to-bg-tertiary/30 hover:shadow-inner border border-transparent hover:border-primary-custom/20",children:t.username})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("label",{className:"text-xs font-medium text-text-secondary flex items-center",children:[e.jsx(g,{className:"w-3 h-3 mr-1"}),"Mật khẩu"]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[c&&!p&&e.jsx("button",{onClick:()=>A(h,"Mật khẩu"),className:"p-1.5 rounded-lg hover:bg-gradient-to-r hover:from-green-500/20 hover:to-green-400/10 text-text-tertiary hover:text-green-500 transition-all duration-300 transform hover:scale-110 hover:-translate-y-0.5 hover:shadow-lg active:scale-95 active:translate-y-0","aria-label":"Copy password",children:e.jsx(C,{className:"w-3 h-3 transition-transform duration-300 hover:rotate-12"})}),e.jsx("button",{onClick:async()=>{ce(),c?u(!1):!P||B()?await R():$(!0)},className:"p-1.5 rounded-lg hover:bg-gradient-to-r hover:from-blue-500/20 hover:to-blue-400/10 text-text-tertiary hover:text-blue-500 transition-all duration-300 transform hover:scale-110 hover:-translate-y-0.5 hover:shadow-lg active:scale-95 active:translate-y-0 disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none","aria-label":c?"Hide password":"Show password",disabled:p,children:p?e.jsx(S,{className:"w-3 h-3 animate-spin"}):c?e.jsx(f,{className:"w-3 h-3 transition-transform duration-300 hover:scale-110"}):e.jsx(y,{className:"w-3 h-3 transition-transform duration-300 hover:scale-110"})})]})]}),e.jsx("div",{className:"bg-gradient-to-r from-bg-tertiary/30 to-bg-tertiary/20 rounded-lg px-3 py-2 text-sm font-mono transition-all duration-300 hover:from-bg-tertiary/40 hover:to-bg-tertiary/30 hover:shadow-inner border border-transparent hover:border-primary-custom/20",children:e.jsx("span",{className:"text-text-primary break-all transition-all duration-300",children:p?e.jsx("span",{className:"animate-pulse",children:"Đang giải mã..."}):c?e.jsx("span",{className:"animate-in fade-in duration-300",children:h}):e.jsx("span",{className:"tracking-wider",children:"•".repeat(8)})})})]})]})]}),e.jsx(ge,{isOpen:L,onClose:()=>$(!1),serviceName:t.serviceName,onSuccess:()=>{$(!1),R()}})]})},ve=({score:t})=>{const s={0:{label:"Rất yếu",color:"bg-red-500",textColor:"text-red-500"},1:{label:"Yếu",color:"bg-orange-500",textColor:"text-orange-500"},2:{label:"Trung bình",color:"bg-yellow-500",textColor:"text-yellow-500"},3:{label:"Mạnh",color:"bg-blue-500",textColor:"text-blue-500"},4:{label:"Rất mạnh",color:"bg-green-500",textColor:"text-green-500"}}[t],r=20*(t+1);return e.jsxs("div",{className:"mt-2",children:[e.jsx("div",{className:"w-full bg-bg-tertiary rounded-full h-2",children:e.jsx("div",{className:`h-2 rounded-full transition-all duration-300 ${s.color}`,style:{width:`${r}%`}})}),e.jsx("p",{className:`text-sm mt-1 font-semibold ${s.textColor}`,children:s.label})]})},je=({password:t,onPasswordChange:s,placeholder:a})=>{const[n,o]=r.useState({length:16,includeUppercase:!0,includeLowercase:!0,includeNumbers:!0,includeSymbols:!0}),[l,c]=r.useState(0),[d,m]=r.useState(!1);r.useEffect(()=>{if(t&&t.length>0){const e=i(t);c(e.score)}else c(0)},[t]);return e.jsxs("div",{className:"mb-5",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("label",{htmlFor:"password",className:"block text-text-primary text-sm font-bold",children:"Mật khẩu"}),e.jsxs("button",{type:"button",onClick:()=>m(!d),className:"text-sm text-primary-custom hover:underline flex items-center transition-colors duration-200",children:["Tùy chọn ",d?e.jsx(L,{className:"ml-1"}):e.jsx($,{className:"ml-1"})]})]}),d&&e.jsxs("div",{className:"mb-3 p-4 bg-bg-tertiary rounded-lg border border-border-primary",children:[e.jsxs("div",{className:"mb-4",children:[e.jsxs("label",{htmlFor:"length",className:"block text-sm font-medium text-text-primary mb-1",children:["Độ dài: ",n.length]}),e.jsx("input",{type:"range",id:"length",min:"8",max:"64",value:n.length,onChange:e=>o({...n,length:parseInt(e.target.value,10)}),className:"w-full h-2 bg-input-bg rounded-lg appearance-none cursor-pointer accent-primary-custom"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-x-4 gap-y-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("input",{type:"checkbox",id:"uppercase",checked:n.includeUppercase,onChange:e=>o({...n,includeUppercase:e.target.checked}),className:"mr-2 h-4 w-4 rounded accent-primary-custom"}),e.jsx("label",{htmlFor:"uppercase",className:"text-text-primary",children:"Chữ hoa (A-Z)"})]}),e.jsxs("div",{children:[e.jsx("input",{type:"checkbox",id:"lowercase",checked:n.includeLowercase,onChange:e=>o({...n,includeLowercase:e.target.checked}),className:"mr-2 h-4 w-4 rounded accent-primary-custom"}),e.jsx("label",{htmlFor:"lowercase",className:"text-text-primary",children:"Chữ thường (a-z)"})]}),e.jsxs("div",{children:[e.jsx("input",{type:"checkbox",id:"numbers",checked:n.includeNumbers,onChange:e=>o({...n,includeNumbers:e.target.checked}),className:"mr-2 h-4 w-4 rounded accent-primary-custom"}),e.jsx("label",{htmlFor:"numbers",className:"text-text-primary",children:"Số (0-9)"})]}),e.jsxs("div",{children:[e.jsx("input",{type:"checkbox",id:"symbols",checked:n.includeSymbols,onChange:e=>o({...n,includeSymbols:e.target.checked}),className:"mr-2 h-4 w-4 rounded accent-primary-custom"}),e.jsx("label",{htmlFor:"symbols",className:"text-text-primary",children:"Ký tự (!@#)"})]})]})]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",id:"password",value:t||"",onChange:e=>s(e.target.value),className:"w-full px-4 py-4 bg-input-bg border border-input-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-custom transition text-text-primary pr-12 text-base",placeholder:a||"••••••••"}),e.jsx("button",{type:"button",onClick:()=>{const e=(e=>{const{length:t=16,includeUppercase:s=!0,includeLowercase:r=!0,includeNumbers:a=!0,includeSymbols:n=!0}=e||{},o="ABCDEFGHIJKLMNOPQRSTUVWXYZ",i="abcdefghijklmnopqrstuvwxyz",l="0123456789",c="!@#$%^&*()_+-=[]{}|;:,.<>?";let d="",m=[];if(s&&(d+=o,m.push(o[Math.floor(26*Math.random())])),r&&(d+=i,m.push(i[Math.floor(26*Math.random())])),a&&(d+=l,m.push(l[Math.floor(10*Math.random())])),n&&(d+=c,m.push(c[Math.floor(26*Math.random())])),""===d)return"";let u=m.join("");const h=t-u.length;for(let x=0;x<h;x++)u+=d[Math.floor(Math.random()*d.length)];return u.split("").sort(()=>.5-Math.random()).join("")})(n);s(e)},className:"absolute inset-y-0 right-0 flex items-center px-3 text-text-tertiary hover:text-primary-custom transition-colors",title:"Tạo mật khẩu ngẫu nhiên theo tùy chọn",children:e.jsx(F,{className:"text-lg"})})]}),e.jsx("div",{className:"mt-2 h-6",children:t&&t.length>0&&e.jsx(ve,{score:l})})]})},we=({isOpen:t,onClose:s,onSuccess:a,token:i,API_URL:l})=>{const[c,d]=r.useState(""),[m,u]=r.useState(""),[h,x]=r.useState(""),[p,g]=r.useState(""),[f,y]=r.useState(!1);return t?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 flex justify-center items-center z-50 transition-opacity duration-300 p-4",children:e.jsxs("div",{className:"bg-modal-bg rounded-xl shadow-custom-lg p-6 lg:p-8 w-full max-w-lg transform transition-all duration-300 scale-95 opacity-0 animate-fade-in-scale border border-border-primary max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6 border-b border-border-primary pb-4",children:[e.jsx("h2",{className:"text-2xl font-bold text-text-primary",children:"Thêm Mật khẩu Mới"}),e.jsx("button",{onClick:s,className:"text-text-tertiary hover:text-text-secondary transition-colors",children:e.jsx(b,{size:28})})]}),e.jsxs("form",{onSubmit:async e=>{var t,r;if(e.preventDefault(),c&&m&&h){y(!0);try{const e=await o.post(l,{serviceName:c,username:m,password:h,category:p},{headers:{"x-auth-token":i}});n.success("Đã thêm mật khẩu thành công!"),d(""),u(""),x(""),g(""),a(e.data),s()}catch(b){n.error((null==(r=null==(t=b.response)?void 0:t.data)?void 0:r.msg)||"Không thể thêm mật khẩu.")}finally{y(!1)}}else n.error("Vui lòng điền đầy đủ các trường.")},children:[e.jsxs("div",{className:"mb-5",children:[e.jsx("label",{htmlFor:"serviceName",className:"block text-text-primary text-sm font-bold mb-2",children:"Tên dịch vụ"}),e.jsx("input",{type:"text",id:"serviceName",value:c,onChange:e=>d(e.target.value),className:"w-full px-4 py-4 bg-input-bg border border-input-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-custom transition text-text-primary text-base",placeholder:"Ví dụ: Google, Facebook"})]}),e.jsxs("div",{className:"mb-5",children:[e.jsx("label",{htmlFor:"username",className:"block text-text-primary text-sm font-bold mb-2",children:"Tên người dùng hoặc Email"}),e.jsx("input",{type:"text",id:"username",value:m,onChange:e=>u(e.target.value),className:"w-full px-4 py-4 bg-input-bg border border-input-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-custom transition text-text-primary text-base",placeholder:"tendangnhap_cua_ban"})]}),e.jsxs("div",{className:"mb-5",children:[e.jsx("label",{htmlFor:"category",className:"block text-text-primary text-sm font-bold mb-2",children:"Danh mục (tùy chọn)"}),e.jsx("input",{type:"text",id:"category",value:p,onChange:e=>g(e.target.value),className:"w-full px-4 py-4 bg-input-bg border border-input-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-custom transition text-text-primary text-base",placeholder:"Ví dụ: Công việc, Mạng xã hội"})]}),e.jsx(je,{password:h,onPasswordChange:x}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-end space-y-3 sm:space-y-0 sm:space-x-4 pb-20 sm:pb-0",children:[e.jsx("button",{type:"button",onClick:s,className:"w-full sm:w-auto bg-bg-tertiary hover:bg-text-tertiary text-text-primary font-bold py-4 px-6 rounded-lg focus:outline-none focus:shadow-outline transition-colors min-h-[48px]",children:"Hủy"}),e.jsx("button",{type:"submit",disabled:f,className:"w-full sm:w-auto bg-gradient-to-r from-primary-custom to-secondary-custom hover:from-primary-hover hover:to-purple-600 text-white font-bold py-4 px-6 rounded-lg focus:outline-none focus:shadow-outline disabled:opacity-50 disabled:cursor-not-allowed transition-all transform hover:-translate-y-1 shadow-custom min-h-[48px]",children:f?"Đang lưu...":"Lưu Mật khẩu"})]})]})]})}):null},Ne=({currentPage:t,totalPages:s,totalItems:r,itemsPerPage:n,onPageChange:o,className:i=""})=>{const l=s>1?(()=>{const e=[],r=[];for(let a=Math.max(2,t-2);a<=Math.min(s-1,t+2);a++)e.push(a);return t-2>2?r.push(1,"..."):r.push(1),r.push(...e),t+2<s-1?r.push("...",s):r.push(s),r})():[],c=(t-1)*n+1,d=Math.min(t*n,r);return s<=1?null:e.jsxs("div",{className:`flex flex-col sm:flex-row items-center justify-between gap-4 ${i}`,children:[e.jsxs("div",{className:"text-sm text-text-secondary",children:["Hiển thị ",e.jsx("span",{className:"font-medium text-text-primary",children:c})," đến"," ",e.jsx("span",{className:"font-medium text-text-primary",children:d})," trong tổng số"," ",e.jsx("span",{className:"font-medium text-text-primary",children:r})," mật khẩu"]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("button",{onClick:()=>o(t-1),disabled:1===t,className:"flex items-center justify-center w-10 h-10 rounded-lg border border-border-primary bg-card-bg text-text-secondary hover:text-text-primary hover:bg-bg-tertiary transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:bg-card-bg disabled:hover:text-text-secondary","aria-label":"Trang trước",children:e.jsx(P,{className:"w-4 h-4"})}),l.map((s,r)=>e.jsx(a.Fragment,{children:"..."===s?e.jsx("div",{className:"flex items-center justify-center w-10 h-10 text-text-tertiary",children:e.jsx(B,{className:"w-4 h-4"})}):e.jsx("button",{onClick:()=>o(s),className:"flex items-center justify-center w-10 h-10 rounded-lg border transition-all duration-200 font-medium text-sm "+(t===s?"border-primary-custom bg-primary-custom text-white shadow-lg":"border-border-primary bg-card-bg text-text-secondary hover:text-text-primary hover:bg-bg-tertiary"),"aria-label":`Trang ${s}`,"aria-current":t===s?"page":void 0,children:s})},r)),e.jsx("button",{onClick:()=>o(t+1),disabled:t===s,className:"flex items-center justify-center w-10 h-10 rounded-lg border border-border-primary bg-card-bg text-text-secondary hover:text-text-primary hover:bg-bg-tertiary transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:bg-card-bg disabled:hover:text-text-secondary","aria-label":"Trang sau",children:e.jsx(A,{className:"w-4 h-4"})})]})]})},ke=({isOpen:t,onClose:s,passwordData:a,onUpdateSuccess:i,token:l,API_URL:c})=>{const[d,m]=r.useState(""),[u,h]=r.useState(""),[x,p]=r.useState(""),[g,f]=r.useState(""),[y,v]=r.useState(!1);r.useEffect(()=>{a&&(m(a.serviceName||""),h(a.username||""),f(a.category||""),p(""))},[a]);return t?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 flex justify-center items-center z-50 transition-opacity duration-300 p-4",children:e.jsxs("div",{className:"bg-modal-bg rounded-xl shadow-custom-lg p-6 lg:p-8 w-full max-w-lg transform transition-all duration-300 scale-95 opacity-0 animate-fade-in-scale border border-border-primary max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6 border-b border-border-primary pb-4",children:[e.jsx("h2",{className:"text-2xl font-bold text-text-primary",children:"Chỉnh sửa Mật khẩu"}),e.jsx("button",{onClick:s,className:"text-text-tertiary hover:text-text-secondary transition-colors",children:e.jsx(b,{size:28})})]}),e.jsxs("form",{onSubmit:async e=>{var t,r;e.preventDefault(),v(!0);const m={serviceName:d,username:u,category:g};x&&(m.password=x);try{const e=await o.put(`${c}/${a._id}`,m,{headers:{"x-auth-token":l}});n.success("Đã cập nhật mật khẩu thành công!"),i(e.data.data),s()}catch(h){n.error((null==(r=null==(t=h.response)?void 0:t.data)?void 0:r.msg)||"Không thể cập nhật mật khẩu.")}finally{v(!1)}},children:[e.jsxs("div",{className:"mb-5",children:[e.jsx("label",{htmlFor:"serviceName",className:"block text-text-primary text-sm font-bold mb-2",children:"Tên dịch vụ"}),e.jsx("input",{type:"text",id:"serviceName",value:d,onChange:e=>m(e.target.value),className:"w-full px-4 py-3 bg-input-bg border border-input-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-custom transition text-text-primary"})]}),e.jsxs("div",{className:"mb-5",children:[e.jsx("label",{htmlFor:"username",className:"block text-text-primary text-sm font-bold mb-2",children:"Tên người dùng hoặc Email"}),e.jsx("input",{type:"text",id:"username",value:u,onChange:e=>h(e.target.value),className:"w-full px-4 py-3 bg-input-bg border border-input-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-custom transition text-text-primary"})]}),e.jsxs("div",{className:"mb-5",children:[e.jsx("label",{htmlFor:"category",className:"block text-text-primary text-sm font-bold mb-2",children:"Danh mục"}),e.jsx("input",{type:"text",id:"category",value:g,onChange:e=>f(e.target.value),className:"w-full px-4 py-3 bg-input-bg border border-input-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-custom transition text-text-primary"})]}),e.jsx(je,{password:x,onPasswordChange:p,placeholder:"Để trống để giữ mật khẩu hiện tại"}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-end space-y-3 sm:space-y-0 sm:space-x-4 pb-20 sm:pb-0",children:[e.jsx("button",{type:"button",onClick:s,className:"w-full sm:w-auto bg-bg-tertiary hover:bg-text-tertiary text-text-primary font-bold py-3 px-6 rounded-lg focus:outline-none focus:shadow-outline transition-colors",children:"Hủy"}),e.jsx("button",{type:"submit",disabled:y,className:"w-full sm:w-auto bg-gradient-to-r from-primary-custom to-secondary-custom hover:from-primary-hover hover:to-purple-600 text-white font-bold py-3 px-6 rounded-lg focus:outline-none focus:shadow-outline disabled:opacity-50 disabled:cursor-not-allowed transition-all transform hover:-translate-y-1 shadow-custom",children:y?"Đang cập nhật...":"Cập nhật"})]})]})]})}):null};X.register(Y,I,K,H);const Ce=({passwords:t})=>{const{isDark:s}=u(),r=(()=>{if(!t||0===t.length)return{labels:[],datasets:[]};const e=t.reduce((e,t)=>{const s=t.serviceName.trim()||"Uncategorized";return e[s]=(e[s]||0)+1,e},{});return{labels:Object.keys(e),datasets:[{label:"Passwords",data:Object.values(e),backgroundColor:s?["#EF4444","#3B82F6","#F59E0B","#10B981","#8B5CF6","#F97316","#EC4899","#6366F1","#84CC16","#06B6D4"]:["#DC2626","#2563EB","#D97706","#059669","#7C3AED","#EA580C","#DB2777","#4F46E5","#65A30D","#0891B2"],hoverBackgroundColor:s?["#F87171","#60A5FA","#FBBF24","#34D399","#A78BFA","#FB923C","#F472B6","#818CF8","#A3E635","#22D3EE"]:["#B91C1C","#1D4ED8","#B45309","#047857","#6D28D9","#C2410C","#BE185D","#3730A3","#4D7C0F","#0E7490"],borderColor:s?"#374151":"#ffffff",borderWidth:2}]}})(),a={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:window.innerWidth<768?"bottom":"right",labels:{color:s?"#d1d5db":"#374151",font:{size:window.innerWidth<768?11:12},padding:window.innerWidth<768?15:20,usePointStyle:!0,pointStyle:"circle"}},title:{display:!0,text:"Phân bố mật khẩu theo dịch vụ",color:s?"#f9fafb":"#111827",font:{size:window.innerWidth<768?14:16,weight:"bold"},padding:{top:10,bottom:20}},tooltip:{backgroundColor:s?"#1f2937":"#ffffff",titleColor:s?"#f9fafb":"#111827",bodyColor:s?"#d1d5db":"#374151",borderColor:s?"#374151":"#e5e7eb",borderWidth:1,cornerRadius:8,displayColors:!0,callbacks:{label:function(e){const t=e.label||"",s=e.parsed;return`${t}: ${s} (${(s/e.dataset.data.reduce((e,t)=>e+t,0)*100).toFixed(1)}%)`}}}},layout:{padding:{top:10,bottom:10,left:10,right:10}}};return r.labels&&0!==r.labels.length?e.jsx("div",{className:"relative w-full",children:e.jsx("div",{className:"h-48 sm:h-56 lg:h-64 w-full",children:e.jsx(_,{data:r,options:a})})}):e.jsxs("div",{className:"flex flex-col items-center justify-center py-8 text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-bg-tertiary rounded-full flex items-center justify-center mb-4",children:e.jsx("svg",{className:"w-8 h-8 text-text-tertiary",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})}),e.jsx("p",{className:"text-text-secondary text-sm",children:"Chưa có dữ liệu để hiển thị"}),e.jsx("p",{className:"text-text-tertiary text-xs mt-1",children:"Thêm mật khẩu để xem thống kê"})]})},Se=({children:t,delay:r=0,className:a="",...n})=>{const o={hidden:{opacity:0,y:30,scale:.95},visible:{opacity:1,y:0,scale:1,transition:{duration:.5,delay:r,ease:[.25,.46,.45,.94]}}};return e.jsx(s.div,{variants:o,initial:"hidden",animate:"visible",whileHover:"hover",className:a,hover:{y:-8,scale:1.02,boxShadow:"0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04)",transition:{duration:.3,ease:"easeOut"}},...n,children:t})},Me=({children:t,onRefresh:s,enabled:a=!0,threshold:n=80,className:o="",indicatorClassName:i=""})=>{const{containerRef:l,isRefreshing:c,pullDistance:d,pullIndicatorStyle:m,containerStyle:u,isAtThreshold:h}=((e,t={})=>{const{threshold:s=80,resistance:a=2.5,snapBackDuration:n=300,enabled:o=!0}=t,[i,l]=r.useState(!1),[c,d]=r.useState(0),[m,u]=r.useState(!1),[h,x]=r.useState(!1),p=r.useRef(0),b=r.useRef(0),g=r.useRef(null),f=r.useRef(!1),y=r.useCallback(()=>!(!g.current||!o)&&g.current.scrollTop<=0,[o]),v=r.useCallback(e=>{if(!o||m)return;const t=e.touches[0];p.current=t.clientY,b.current=t.clientY,x(y()),f.current=!1},[o,m,y]),j=r.useCallback(e=>{if(!o||m||!h)return;const t=e.touches[0];b.current=t.clientY;const r=b.current-p.current;if(r>0){e.preventDefault();const t=Math.min(r/a,1.5*s);d(t),l(t>10),t>=s&&!f.current&&(be(),f.current=!0)}},[o,m,h,s,a]),w=r.useCallback(async()=>{if(!o||m||!i)return l(!1),void d(0);if(c>=s){u(!0),ue();try{await e()}catch(t){de()}finally{u(!1)}}l(!1),d(0)},[o,m,i,c,s,e]);r.useEffect(()=>{const e=g.current;if(!e||!o)return;const t={passive:!1};return e.addEventListener("touchstart",v,t),e.addEventListener("touchmove",j,t),e.addEventListener("touchend",w,t),()=>{e.removeEventListener("touchstart",v,t),e.removeEventListener("touchmove",j,t),e.removeEventListener("touchend",w,t)}},[v,j,w,o]);const N={transform:`translateY(${c}px)`,transition:i?"none":`transform ${n}ms ease-out`,opacity:Math.min(c/s,1)},k={transform:`translateY(${Math.min(.5*c,.5*s)}px)`,transition:i?"none":`transform ${n}ms ease-out`};return{containerRef:g,isPulling:i,isRefreshing:m,pullDistance:c,pullIndicatorStyle:N,containerStyle:k,isAtThreshold:c>=s}})(s,{threshold:n,enabled:a,resistance:2.5,snapBackDuration:300});return e.jsxs("div",{className:`relative overflow-hidden ${o}`,children:[e.jsx("div",{className:`absolute top-0 left-0 right-0 flex items-center justify-center z-10 ${i}`,style:{...m,height:`${Math.max(d,0)}px`,marginTop:`-${n}px`},children:e.jsxs("div",{className:"flex flex-col items-center justify-center transition-all duration-200 "+(d>10?"opacity-100":"opacity-0"),children:[e.jsx("div",{className:"relative transition-all duration-300 "+(c?"animate-spin":h?"rotate-180":"rotate-0"),children:c?e.jsx(R,{className:"w-6 h-6 text-primary-custom"}):e.jsx($,{className:"w-6 h-6 transition-colors duration-200 "+(h?"text-primary-custom":"text-text-tertiary")})}),e.jsxs("div",{className:"mt-2 text-center",children:[e.jsx("p",{className:"text-xs font-medium transition-colors duration-200 "+(h?"text-primary-custom":"text-text-tertiary"),children:c?"Đang làm mới...":h?"Thả để làm mới":"Kéo để làm mới"}),e.jsx("div",{className:"mt-1 w-12 h-1 bg-bg-tertiary rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full transition-all duration-200 rounded-full "+(h?"bg-primary-custom":"bg-text-tertiary"),style:{width:`${Math.min(d/n*100,100)}%`}})})]})]})}),e.jsx("div",{ref:l,className:"h-full overflow-y-auto",style:u,children:t})]})},Te=({onClick:t})=>e.jsx(s.button,{variants:{initial:{scale:0,rotate:-180,opacity:0},animate:{scale:1,rotate:0,opacity:1,transition:{type:"spring",stiffness:260,damping:20,delay:.5}},hover:{scale:1.1,rotate:90,boxShadow:"0 10px 25px rgba(59, 130, 246, 0.3)",transition:{duration:.2}},tap:{scale:.95,rotate:45}},initial:"initial",animate:"animate",whileHover:"hover",whileTap:"tap",onClick:t,className:"fixed bottom-24 right-6 md:hidden w-14 h-14 bg-gradient-to-r from-primary-custom to-secondary-custom text-white rounded-full shadow-lg z-40 flex items-center justify-center","aria-label":"Thêm mật khẩu mới",children:e.jsx(s.div,{variants:{hover:{rotate:90,transition:{duration:.2}}},children:e.jsx(U,{className:"text-lg"})})}),Oe="http://localhost:5000/api/passwords",Ee=()=>{const[t,s]=r.useState([]),[a,i]=r.useState(!0),[d,m]=r.useState(null),[u,p]=r.useState(!1),[b,g]=r.useState(!1),[f,y]=r.useState(null),[v,j]=r.useState(""),[w,N]=r.useState("all"),[k,C]=r.useState(1),[S]=r.useState(12),{logout:M,token:T,user:O}=r.useContext(h),E=r.useMemo(()=>{if(!t||0===t.length)return 0;const e=t.map(e=>e.serviceName.trim().toLowerCase());return new Set(e).size},[t]),D=r.useCallback(async()=>{var e,t;try{i(!0);const e=await o.get(Oe,{headers:{"x-auth-token":T}});s(e.data.data),m(null)}catch(r){m("Không thể tải mật khẩu. Máy chủ backend có đang chạy không?"),n.error((null==(t=null==(e=r.response)?void 0:e.data)?void 0:t.msg)||"Không thể tải mật khẩu.")}finally{i(!1)}},[T]);r.useEffect(()=>{D()},[D,T]);const L=async e=>{try{await o.delete(`${Oe}/${e}`,{headers:{"x-auth-token":T}}),s(t.filter(t=>t._id!==e)),n.info("Đã chuyển mật khẩu vào thùng rác.")}catch(r){n.error("Không thể xóa mật khẩu.")}},$=r.useMemo(()=>{const e=t.map(e=>e.category||"Chưa phân loại");return[...new Set(e)]},[t]),F=r.useMemo(()=>t.filter(e=>"all"===w||(e.category||"Chưa phân loại")===w).filter(e=>e.serviceName.toLowerCase().includes(v.toLowerCase())||e.username.toLowerCase().includes(v.toLowerCase())),[t,v,w]),P=Math.ceil(F.length/S),B=(k-1)*S,A=B+S,R=F.slice(B,A);r.useEffect(()=>{C(1)},[v,w]);return e.jsxs(W,{className:"bg-bg-secondary min-h-screen transition-colors duration-300 pb-20 md:pb-0",children:[e.jsx(l,{user:O,onLogout:M}),e.jsxs("div",{className:"flex flex-col lg:flex-row pt-20",children:[e.jsxs("aside",{className:"w-full lg:w-72 lg:flex-shrink-0 p-4 lg:p-6",children:[e.jsx("h2",{className:"text-xl lg:text-2xl font-bold text-text-primary mb-4 lg:mb-6",children:"Thống kê"}),e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-2 lg:grid-cols-1 gap-3 lg:gap-6",children:[e.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-100 dark:from-blue-900/30 dark:to-indigo-900/30 p-4 rounded-xl shadow-custom text-center lg:text-left border border-border-primary",children:[e.jsx("h3",{className:"text-sm font-medium text-text-secondary",children:"Tổng số mật khẩu"}),e.jsx("p",{className:"mt-1 text-4xl font-bold text-text-primary",children:t.length})]}),e.jsxs("div",{className:"bg-gradient-to-br from-green-50 to-teal-100 dark:from-green-900/30 dark:to-teal-900/30 p-4 rounded-xl shadow-custom text-center lg:text-left border border-border-primary",children:[e.jsx("h3",{className:"text-sm font-medium text-text-secondary",children:"Tổng số dịch vụ"}),e.jsx("p",{className:"mt-1 text-4xl font-bold text-text-primary",children:E})]}),e.jsxs("div",{className:"bg-card-bg p-4 lg:p-6 rounded-xl shadow-custom col-span-2 lg:col-span-1 border border-border-primary",children:[e.jsx("h3",{className:"text-sm lg:text-base font-medium text-text-secondary mb-4 text-center lg:text-left",children:"Phân bố theo dịch vụ"}),e.jsx("div",{className:"w-full",children:e.jsx(Ce,{passwords:t})})]})]})]}),e.jsx("main",{className:"flex-1 min-w-0",children:e.jsx(Me,{onRefresh:async()=>{pe(),await D()},className:"h-full",enabled:!a,children:e.jsxs("div",{className:"p-4 lg:p-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-6 lg:mb-8 gap-4",children:[e.jsx("div",{children:e.jsx("h1",{className:"text-2xl lg:text-3xl font-bold text-text-primary",children:"Mật khẩu"})}),e.jsxs("button",{onClick:()=>{ce(),p(!0)},className:"w-full sm:w-auto bg-gradient-to-r from-primary-custom to-secondary-custom hover:from-primary-hover hover:to-purple-600 text-white font-bold py-4 px-6 rounded-lg flex items-center justify-center transition-all duration-300 ease-in-out transform hover:-translate-y-1 hover:scale-105 shadow-custom hover:shadow-custom-lg min-h-[48px] text-lg active:scale-95","aria-label":"Add new password",children:[e.jsx(U,{className:"mr-2 text-lg transition-transform duration-200 group-hover:rotate-90"}),"Thêm Mới"]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 mb-6",children:[e.jsxs("div",{className:"relative flex-grow",children:[e.jsx("span",{className:"absolute inset-y-0 left-0 flex items-center pl-3",children:e.jsx(z,{className:"h-5 w-5 text-text-tertiary"})}),e.jsx("input",{type:"text",placeholder:"Tìm kiếm theo dịch vụ hoặc tên người dùng...",value:v,onChange:e=>j(e.target.value),onFocus:()=>me(),className:"w-full pl-10 pr-4 py-3 border border-input-border rounded-lg bg-input-bg text-text-primary placeholder-text-tertiary focus:outline-none focus:ring-2 focus:ring-primary-custom shadow-custom transition-colors duration-200"})]}),e.jsxs("div",{className:"relative",children:[e.jsxs("select",{value:w,onChange:e=>{ce(),N(e.target.value)},className:"w-full sm:w-48 pl-3 pr-10 py-3 border border-input-border rounded-lg bg-input-bg text-text-primary focus:outline-none focus:ring-2 focus:ring-primary-custom shadow-custom appearance-none transition-colors duration-200",children:[e.jsx("option",{value:"all",children:"Tất cả danh mục"}),$.map(t=>e.jsx("option",{value:t,children:t},t))]}),e.jsx("div",{className:"pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-text-secondary",children:e.jsx("svg",{className:"fill-current h-4 w-4",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",children:e.jsx("path",{d:"M9.293 12.95l.707.707L15.657 8l-1.414-1.414L10 10.828 5.757 6.586 4.343 8z"})})})]})]}),a&&0===t.length?e.jsx(x,{size:"lg",text:"Đang tải mật khẩu..."}):d?e.jsx("p",{className:"text-center text-red-500",children:d}):0===t.length?e.jsx("p",{className:"text-center text-gray-500",children:"Không tìm thấy mật khẩu nào. Hãy thêm mật khẩu đầu tiên của bạn!"}):0===F.length?e.jsx("p",{className:"text-center text-gray-500",children:"Không có mật khẩu nào khớp với tìm kiếm hoặc bộ lọc của bạn."}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 2xl:grid-cols-5 gap-4",children:R.map((t,s)=>e.jsx(Se,{delay:.1*s,children:e.jsx(ye,{data:t,onSoftDelete:L,onEditClick:e=>{y(e),g(!0)},token:T,API_URL:Oe})},t._id))}),P>1&&e.jsx("div",{className:"mt-8",children:e.jsx(Ne,{currentPage:k,totalPages:P,totalItems:F.length,itemsPerPage:S,onPageChange:C})})]})]})})})]}),e.jsx(we,{isOpen:u,onClose:()=>p(!1),onSuccess:e=>{s([...t,e.data])},token:T,API_URL:Oe}),f&&e.jsx(ke,{isOpen:b,onClose:()=>{g(!1),y(null)},onUpdateSuccess:e=>{s(t.map(t=>t._id===e._id?e:t))},passwordData:f,token:T,API_URL:Oe}),e.jsx(Te,{onClick:()=>p(!0)}),e.jsx(c,{onAddPassword:()=>p(!0)})]})};export{Ee as default};
